{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,uCAUA,MAAMC,EAAO,CACXC,KAAMC,SAASC,cAAc,gBAC7BC,QAASF,SAASC,cAAc,YAChCE,MAAOH,SAASC,cAAc,aAC9BG,gBAAiBJ,SAASC,cAAc,qBACxCI,KAAML,SAASC,cAAc,sBAC7BK,QAASN,SAASC,cAAc,uBAE5BM,EAAoB,IAAI,EAAAC,EAAAC,mBACxBC,EAAkB,IAAIC,EAAAf,GAAJ,CAAmB,aAAc,CACvDgB,aAAc,MACdC,aAAc,MAEVC,EAAW,IAAIC,sBAiFrB,SAAoBC,GAClBA,EAAQC,SAAQC,IACVA,EAAMC,gBACRC,GAAY,G,GApFoC,CAAEC,WAAY,UACpE,IAAIC,EAAmB,EA6BvBC,eAAeH,IACb,IACE,MAAMI,QAAajB,EAAkBkB,cAC/BC,EAAYF,EAAKE,UACjBC,EAASH,EAAKI,KAEpB,IAAKD,EAAOE,OAIV,YAHAC,EAAAC,OAAOC,QACL,6EA0BR,SAA6BL,GAC3B7B,EAAKI,QAAQ+B,mBAAmB,aAAa,EAAAC,EAAAC,cAAaR,G,CAtBxDS,CAAoBT,GAEfL,GACHQ,EAAAC,OAAOM,QAAQ,oBAAoBX,aAGrCJ,GAAoBK,EAAOE,OAEvBP,EAAmBI,EACrBZ,EAASwB,QAAQxC,EAAKK,OAEtBW,EAASyB,UAAUzC,EAAKK,M,CAE1B,MAAOqC,GACPV,EAAAC,OAAOU,QAAQ,sD,CAChB,QACCC,EAAY5C,EAAKM,iBACjBM,EAAgBiC,S,EAapB,SAASD,EAAYE,GACnBA,EAAQC,UAAUC,IAAI,Y,CAGxB,SAASC,EAAYH,GACnBA,EAAQC,UAAUG,OAAO,Y,CA3E3BlD,EAAKC,KAAKkD,iBAAiB,UAG3B,SAAkBC,GAChBA,EAAIC,iBA8DJrD,EAAKI,QAAQkD,UAAY,GACzB9B,EAAmB,EA7DnBR,EAASyB,UAAUzC,EAAKK,OAExB,MAAMkD,YAAEA,EAAWC,UAAEA,EAASC,YAAEA,EAAWC,QAAEA,GAC3CN,EAAIO,cAAcC,SAOpB,GALAnD,EAAkBoD,MAAQN,EAAYO,MACtCrD,EAAkBsD,WAAaP,EAAUM,MACzCrD,EAAkBgD,YAAcA,EAAYK,MAC5CrD,EAAkBuD,SAAWN,EAAQI,OAEhCrD,EAAkBoD,MAErB,YADA7B,EAAAC,OAAOgC,KAAK,oCAIdxD,EAAkByD,YAClBjB,EAAYjD,EAAKM,iBACjBsC,EAAY5C,EAAKQ,SACjBc,G,IAvBFtB,EAAKC,KAAKkD,iBAAiB,SAqF3B,SAAgBC,GACdpD,EAAKO,KAAK4D,YAAc,GAAGf,EAAIO,cAAcC,SAASF,QAAQI,QAC9Db,EAAYjD,EAAKQ,Q","sources":["src/js/infinite-scroll.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { Notify } from 'notiflix/build/notiflix-notify-aio';\n\nimport { PixabayApiService } from './pixabay-service';\nimport { createMarkup } from './markup';\n\n// ===================================================================\n\nconst refs = {\n  form: document.querySelector('.search-form'),\n  gallery: document.querySelector('.gallery'),\n  guard: document.querySelector('.js-guard'),\n  loaderContainer: document.querySelector('.loader-container'),\n  span: document.querySelector('.js-selected-value'),\n  options: document.querySelector('.options-container'),\n};\nconst pixabayApiService = new PixabayApiService();\nconst galleryLightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\nconst observer = new IntersectionObserver(onLoadMore, { rootMargin: '600px' });\nlet totalShownImages = 0;\n\nrefs.form.addEventListener('submit', onSearch);\nrefs.form.addEventListener('input', onSpan);\n\nfunction onSearch(evt) {\n  evt.preventDefault();\n  clearGallery();\n  observer.unobserve(refs.guard);\n\n  const { searchQuery, imageType, orientation, perPage } =\n    evt.currentTarget.elements;\n\n  pixabayApiService.query = searchQuery.value;\n  pixabayApiService.image_type = imageType.value;\n  pixabayApiService.orientation = orientation.value;\n  pixabayApiService.per_page = perPage.value;\n\n  if (!pixabayApiService.query) {\n    Notify.info('Please, enter your search query.');\n    return;\n  }\n\n  pixabayApiService.resetPage();\n  showElement(refs.loaderContainer);\n  hideElement(refs.options);\n  loadImages();\n}\n\nasync function loadImages() {\n  try {\n    const data = await pixabayApiService.fetchImages();\n    const totalHits = data.totalHits;\n    const images = data.hits;\n\n    if (!images.length) {\n      Notify.warning(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      return;\n    }\n\n    appendGalleryMarkup(images);\n\n    if (!totalShownImages) {\n      Notify.success(`Hooray! We found ${totalHits} images.`);\n    }\n\n    totalShownImages += images.length;\n\n    if (totalShownImages < totalHits) {\n      observer.observe(refs.guard);\n    } else {\n      observer.unobserve(refs.guard);\n    }\n  } catch (err) {\n    Notify.failure('Oops! Something went wrong! Try reloading the page!');\n  } finally {\n    hideElement(refs.loaderContainer);\n    galleryLightbox.refresh();\n  }\n}\n\nfunction appendGalleryMarkup(images) {\n  refs.gallery.insertAdjacentHTML('beforeend', createMarkup(images));\n}\n\nfunction clearGallery() {\n  refs.gallery.innerHTML = '';\n  totalShownImages = 0;\n}\n\nfunction hideElement(element) {\n  element.classList.add('is-hidden');\n}\n\nfunction showElement(element) {\n  element.classList.remove('is-hidden');\n}\n\nfunction onLoadMore(entries) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      loadImages();\n    }\n  });\n}\n\nfunction onSpan(evt) {\n  refs.span.textContent = `${evt.currentTarget.elements.perPage.value}`;\n  showElement(refs.options);\n}\n"],"names":["$fZKcF","parcelRequire","$7f13665ecc617d63$var$refs","form","document","querySelector","gallery","guard","loaderContainer","span","options","$7f13665ecc617d63$var$pixabayApiService","$iAt1l","PixabayApiService","$7f13665ecc617d63$var$galleryLightbox","$parcel$interopDefault","captionsData","captionDelay","$7f13665ecc617d63$var$observer","IntersectionObserver","entries","forEach","entry","isIntersecting","$7f13665ecc617d63$var$loadImages","rootMargin","$7f13665ecc617d63$var$totalShownImages","async","data","fetchImages","totalHits","images","hits","length","$iQIUW","Notify","warning","insertAdjacentHTML","$3huUq","createMarkup","$7f13665ecc617d63$var$appendGalleryMarkup","success","observe","unobserve","err","failure","$7f13665ecc617d63$var$hideElement","refresh","element","classList","add","$7f13665ecc617d63$var$showElement","remove","addEventListener","evt","preventDefault","innerHTML","searchQuery","imageType","orientation","perPage","currentTarget","elements","query","value","image_type","per_page","info","resetPage","textContent"],"version":3,"file":"infinite-scroll.f8ec9c1d.js.map"}