{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,iEAUMC,EAAO,CACXC,KAAMC,SAASC,cAAc,gBAC7BC,QAASF,SAASC,cAAc,YAChCE,YAAaH,SAASC,cAAc,cACpCG,gBAAiBJ,SAASC,cAAc,qBACxCI,KAAML,SAASC,cAAc,sBAC7BK,QAASN,SAASC,cAAc,uBAE5BM,EAAoB,IAAI,EAAAC,EAAAC,mBACxBC,EAAkB,IAAIC,EAAAC,GAAJ,CAAmB,aAAc,CACvDC,aAAc,MACdC,aAAc,MAEZC,EAAmB,E,SA6BRC,I,OAAAC,EAAUC,MAAAC,KAAAC,U,UAAVH,I,OAAAA,EAAfN,EAAAf,EAAA,CAAAe,EAAAU,GAAAC,MAAA,SAAAC,I,IAEUC,EACAC,EACAC,E,2FAFanB,EAAkBoB,c,UAA/BH,EAAII,EAAAC,KACJJ,EAAYD,EAAKC,WACjBC,EAASF,EAAKM,MAERC,OAAM,C,sBAChBC,EAAAC,OAAOC,QACL,4E,0BAKJC,EAAoBT,GAEfX,EAGHqB,IAFAJ,EAAAC,OAAOI,QAAQ,oBAA8BC,OAAVb,EAAU,cAK/CV,GAAoBW,EAAOK,QAEJN,EACrBc,EAAYzC,EAAKK,aAEjBqC,EAAY1C,EAAKK,a,kDAGnB6B,EAAAC,OAAOQ,QAAQ,uD,yBAEfD,EAAY1C,EAAKM,iBACjBM,EAAgBgC,U,8EAhCKxB,MAAAC,KAAAC,U,CAoCzB,SAASe,EAAoBT,GAC3B5B,EAAKI,QAAQyC,mBAAmB,aAAa,EAAAC,EAAAC,cAAanB,G,CAS5D,SAASc,EAAYM,GACnBA,EAAQC,UAAUC,IAAI,Y,CAGxB,SAAST,EAAYO,GACnBA,EAAQC,UAAUE,OAAO,Y,CAG3B,SAASb,IACP,IAAQc,EAAuBlD,SAC5BC,cAAc,YACdkD,kBAAkBC,wBAFbC,OAIRC,OAAOC,SAAS,CACdC,IAAkB,EAAbN,EACLO,SAAU,U,CAxFd3D,EAAKC,KAAK2D,iBAAiB,UAI3B,SAAkBC,GAChBA,EAAIC,iBA+DJ9D,EAAKI,QAAQ2D,UAAY,GACzB9C,EAAmB,EACnByB,EAAY1C,EAAKK,aA9DjB,IACE2D,EAAAH,EAAII,cAAcC,SADZC,EACNH,EADMG,YAAaC,EACnBJ,EADmBI,UAAWC,EAC9BL,EAD8BK,YAAaC,EAC3CN,EAD2CM,QAQ7C,GALA7D,EAAkB8D,MAAQJ,EAAYK,MACtC/D,EAAkBgE,WAAaL,EAAUI,MACzC/D,EAAkB4D,YAAcA,EAAYG,MAC5C/D,EAAkBiE,SAAWJ,EAAQE,OAEhC/D,EAAkB8D,MAErB,YADArC,EAAAC,OAAOwC,KAAK,oCAIdlE,EAAkBmE,YAClBnC,EAAYzC,EAAKM,iBACjBoC,EAAY1C,EAAKQ,SACjBU,G,IAvBFlB,EAAKK,YAAYuD,iBAAiB,QAAS1C,GAC3ClB,EAAKC,KAAK2D,iBAAiB,SA0F3B,SAAgBC,GACd7D,EAAKO,KAAKsE,YAAc,GAA4CrC,OAAzCqB,EAAII,cAAcC,SAASI,QAAQE,OAC9D/B,EAAYzC,EAAKQ,Q","sources":["src/js/load-more-btn.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { Notify } from 'notiflix/build/notiflix-notify-aio';\n\nimport { PixabayApiService } from './pixabay-service';\nimport { createMarkup } from './markup';\n\n// ===================================================================\n\nconst refs = {\n  form: document.querySelector('.search-form'),\n  gallery: document.querySelector('.gallery'),\n  loadMoreBtn: document.querySelector('.load-more'),\n  loaderContainer: document.querySelector('.loader-container'),\n  span: document.querySelector('.js-selected-value'),\n  options: document.querySelector('.options-container'),\n};\nconst pixabayApiService = new PixabayApiService();\nconst galleryLightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\nlet totalShownImages = 0;\n\nrefs.form.addEventListener('submit', onSearch);\nrefs.loadMoreBtn.addEventListener('click', loadImages);\nrefs.form.addEventListener('input', onSpan);\n\nfunction onSearch(evt) {\n  evt.preventDefault();\n  clearGallery();\n\n  const { searchQuery, imageType, orientation, perPage } =\n    evt.currentTarget.elements;\n\n  pixabayApiService.query = searchQuery.value;\n  pixabayApiService.image_type = imageType.value;\n  pixabayApiService.orientation = orientation.value;\n  pixabayApiService.per_page = perPage.value;\n\n  if (!pixabayApiService.query) {\n    Notify.info('Please, enter your search query.');\n    return;\n  }\n\n  pixabayApiService.resetPage();\n  showElement(refs.loaderContainer);\n  hideElement(refs.options);\n  loadImages();\n}\n\nasync function loadImages() {\n  try {\n    const data = await pixabayApiService.fetchImages();\n    const totalHits = data.totalHits;\n    const images = data.hits;\n\n    if (!images.length) {\n      Notify.warning(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      return;\n    }\n\n    appendGalleryMarkup(images);\n\n    if (!totalShownImages) {\n      Notify.success(`Hooray! We found ${totalHits} images.`);\n    } else {\n      smoothScroll();\n    }\n\n    totalShownImages += images.length;\n\n    if (totalShownImages < totalHits) {\n      showElement(refs.loadMoreBtn);\n    } else {\n      hideElement(refs.loadMoreBtn);\n    }\n  } catch (err) {\n    Notify.failure('Oops! Something went wrong! Try reloading the page!');\n  } finally {\n    hideElement(refs.loaderContainer);\n    galleryLightbox.refresh();\n  }\n}\n\nfunction appendGalleryMarkup(images) {\n  refs.gallery.insertAdjacentHTML('beforeend', createMarkup(images));\n}\n\nfunction clearGallery() {\n  refs.gallery.innerHTML = '';\n  totalShownImages = 0;\n  hideElement(refs.loadMoreBtn);\n}\n\nfunction hideElement(element) {\n  element.classList.add('is-hidden');\n}\n\nfunction showElement(element) {\n  element.classList.remove('is-hidden');\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction onSpan(evt) {\n  refs.span.textContent = `${evt.currentTarget.elements.perPage.value}`;\n  showElement(refs.options);\n}\n"],"names":["$bpxeT","parcelRequire","$c2587ba687e3cfc9$var$refs","form","document","querySelector","gallery","loadMoreBtn","loaderContainer","span","options","$c2587ba687e3cfc9$var$pixabayApiService","$hjiBg","PixabayApiService","$c2587ba687e3cfc9$var$galleryLightbox","$parcel$interopDefault","$5IjG7","captionsData","captionDelay","$c2587ba687e3cfc9$var$totalShownImages","$c2587ba687e3cfc9$var$loadImages","$c2587ba687e3cfc9$var$_loadImages","apply","this","arguments","$2TvXO","mark","_callee","data","totalHits","images","fetchImages","_ctx","sent","hits","length","$h6c0i","Notify","warning","$c2587ba687e3cfc9$var$appendGalleryMarkup","$c2587ba687e3cfc9$var$smoothScroll","success","concat","$c2587ba687e3cfc9$var$showElement","$c2587ba687e3cfc9$var$hideElement","failure","refresh","insertAdjacentHTML","$1KhuP","createMarkup","element","classList","add","remove","cardHeight","firstElementChild","getBoundingClientRect","height","window","scrollBy","top","behavior","addEventListener","evt","preventDefault","innerHTML","_elements","currentTarget","elements","searchQuery","imageType","orientation","perPage","query","value","image_type","per_page","info","resetPage","textContent"],"version":3,"file":"load-more-btn.30257d75.js.map"}